<!doctype html>
<html lang="az">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üìò Laboratoriya Kursu </title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f6f8fb;
      margin: 0;
      padding: 20px;
      color: #111;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    .container{max-width:900px;margin:0 auto;}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;}
    .title{font-size:22px;font-weight:700;color:#2b6cb0;  margin-bottom: 10px;
}
.nav-buttons {
  display: flex;
  gap: 10px;
  flex-wrap: wrap; /* ki√ßik ekranda s…ôtird…ôn a≈üaƒüƒ± d√º≈üs√ºn */
  justify-content: center;
  margin: 10px 0;
}

.nav-buttons a {
  flex: 1; /* h…ôr biri b…ôrab…ôr √∂l√ß√ºd…ô olsun */
  min-width: 100px;
  text-align: center;
  padding: 10px;
  border-radius: 6px;
  text-decoration: none;
  font-size: 14px;
  font-weight: bold;
}

.nav-buttons a.blue {
  background: #007bff;
  color: white;
}

.nav-buttons a.red {
  background: #dc3545;
  color: white;
}

/* Mobil ekran √º√ß√ºn x√ºsusi qayda */
@media (max-width: 600px) {
  .nav-buttons {
    flex-direction: column; /* mobil ekranda alt-alta */
    align-items: stretch;
  }
}    .card{background:#fff;padding:15px;margin-bottom:15px;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.08);}
    .q-text{font-size:18px;font-weight:600;margin-bottom:10px;}
    .options{display:flex;flex-direction:column;gap:6px;}
    .opt{display:flex;align-items:center;padding:10px;border-radius:8px;border:1px solid #ccc;background:#f9f9f9;cursor:pointer;transition:.2s;}
    .opt:hover{background:#eef;}
    .opt.disabled{cursor:not-allowed;opacity:.8;}
    .opt.correct{background:#008000;color:#fff;border-color:#008000;}
    .opt.wrong{background:#cc0000;color:#fff;border-color:#cc0000;}
    .letter{font-weight:bold;margin-right:10px;width:22px;text-align:center;}
    .footer-nav{margin-top:20px;}
    .tree{display:flex;flex-direction:column;gap:8px;align-items:flex-start;}
    .block-header{cursor:pointer;padding:6px 10px;border:1px solid #ccc;border-radius:6px;background:#fff;display:flex;align-items:center;gap:6px;}
    .block-header:hover{background:#eef;}
    .arrow{font-size:12px;width:16px;text-align:center;}
    .sub-list{margin-left:25px;margin-top:6px;display:none;flex-wrap:wrap;gap:6px;}
    .sub-list.show{display:flex;}
    .sub-btn{padding:4px 10px;border:1px solid #ccc;border-radius:6px;background:#fff;cursor:pointer;font-size:13px;}
    .sub-btn:hover{background:#eef;}
    .sub-btn.active{background:#2b6cb0;color:#fff;border-color:#2b6cb0;}
    .btn{padding:8px 16px;border:none;border-radius:6px;cursor:pointer;font-weight:600;}
    .btn.prev{background:#2b6cb0;color:#fff;}
    .btn.next{background:#ffdd57;color:#111;}
    .btn:disabled{opacity:.5;cursor:not-allowed;}
  </style>
</head>
<body>
<div style="text-align:center; margin-bottom:10px;">
  <input type="number" id="searchInput" placeholder="Sual n√∂mr…ôsi..." style="padding:5px; width:120px;">
  <button onclick="goToQuestion()">Get</button>
</div>

<div class="container">
  <header>
    <div class="title">üìòLaboratoriya Kursu </div>
    <div style="display:flex;gap:10px;">
      <a href="cavablar.html" class="blue">Suallar (Cavablarla)</a>
      <a href="imtahan.html" class="red" style="background:#ff6666;">ƒ∞mtahan</a>
    </div>
  </header>

  <div id="quizArea"></div>

  <div class="footer-nav">
    <div style="display:flex;justify-content:center;gap:10px;margin-bottom:10px;">
      <button id="prevBtn" class="btn prev" onclick="prevPage()">∆èvv…ôlki</button>
      <button id="nextBtn" class="btn next" onclick="nextPage()">Sonrakƒ±</button>
    </div>
    <div id="tree" class="tree"></div>
  </div>
</div>  

<script>
let questions = [];
const PER_PAGE = 10;
const BLOCK_SIZE = 100;
let currentPageIndex = 0;

async function loadQuestions(){
  try {
    const res = await fetch("https://winter-darkness-2c14.herseydenbiraz4k.workers.dev/");
    if (!res.ok) throw new Error("Suallar tapƒ±lmadƒ±: " + res.status);
    questions = await res.json();
    renderQuiz();
    renderTree();
  } catch(err){
    document.getElementById("quizArea").innerHTML = "X…ôta: " + err.message;
  }
}
loadQuestions();

function el(id){return document.getElementById(id)}

function renderQuiz(){
  const total = questions.length;
  const totalPages = Math.ceil(total / PER_PAGE);

  const area = el("quizArea");
  area.innerHTML = "";
  const start = currentPageIndex*PER_PAGE;
  const end = Math.min(start+PER_PAGE,total);

  for(let i=start;i<end;i++){
    const q=questions[i];
    const card=document.createElement("div");
    card.className="card";
    card.id = "q-" + (i+1);

    const qtext=document.createElement("div");
    qtext.className="q-text";
    qtext.innerHTML =  q.text;
    const opts=document.createElement("div");
    opts.className="options";

    q.options.forEach((txt,idx)=>{
      const opt=document.createElement("div");
      opt.className="opt";
      opt.dataset.optIndex=idx;
      opt.onclick=()=>onOptionClick(q,opt,idx);

      const letter=document.createElement("div");
      letter.className="letter";
      letter.textContent=String.fromCharCode(65+idx);

      const span=document.createElement("div");
      span.textContent=txt;

      opt.appendChild(letter);
      opt.appendChild(span);
      opts.appendChild(opt);
    });

    card.appendChild(qtext);
    card.appendChild(opts);
    area.appendChild(card);
  }

  updateControls(total,totalPages);
  renderTree();
}

// ‚úÖ Cavab se√ßimi
function onOptionClick(q,optElement,idx){
  const card=optElement.closest(".card");
  const allOpts=card.querySelectorAll(".opt");
  // ∆èg…ôr artƒ±q doƒüru cavab se√ßilibs…ô, t…ôkrar icaz…ô verm…ô
  if([...allOpts].some(o=>o.classList.contains("correct"))) return;

  if(idx===q.answer){
    optElement.classList.add("correct");
    allOpts.forEach(o=>o.classList.add("disabled"));
  } else {
    optElement.classList.add("wrong","disabled");
  }
}

function updateControls(total,totalPages){
  el("prevBtn").disabled=(currentPageIndex===0);
  el("nextBtn").disabled=(currentPageIndex===totalPages-1);
}

function prevPage(){if(currentPageIndex>0){currentPageIndex--;renderQuiz();}}
function nextPage(){
  const total = questions.length;
  const totalPages = Math.ceil(total / PER_PAGE);
  if(currentPageIndex<totalPages-1){currentPageIndex++;renderQuiz();}
}
function goToPage(p){currentPageIndex=p;renderQuiz();}

function goToQuestion(){
  const val = parseInt(document.getElementById("searchInput").value);
  const total = questions.length;
  if(!val || val < 1 || val > total){
    alert("D√ºzg√ºn sual n√∂mr…ôsi daxil edin!");
    return;
  }
  const pageIdx = Math.floor((val-1) / PER_PAGE);
  currentPageIndex = pageIdx;
  renderQuiz();
  const targetId = "q-" + val;
  const el = document.getElementById(targetId);
  if(el){el.scrollIntoView({behavior:"smooth", block:"center"});}
}

/* === Tree Pagination === */
function renderTree(){
  const total = questions.length;
  const tree = el("tree");
  tree.innerHTML = "";
  const totalBlocks = Math.ceil(total / BLOCK_SIZE);

  for(let b=0; b<totalBlocks; b++){
    const startB = b*BLOCK_SIZE+1;
    const endB = Math.min((b+1)*BLOCK_SIZE, total);

    const blockDiv = document.createElement("div");
    const header = document.createElement("div");
    header.className = "block-header";

    const arrow = document.createElement("span");
    arrow.className = "arrow";
    arrow.textContent = "‚ñ∂";

    const title = document.createElement("span");
    title.textContent = `${startB}-${endB}`;

    header.appendChild(arrow);
    header.appendChild(title);
    blockDiv.appendChild(header);

    const sub = document.createElement("div");
    sub.className = "sub-list";

    for(let p=startB; p<=endB; p+=PER_PAGE){
      const startP = p;
      const endP = Math.min(p+PER_PAGE-1,endB);
      const pageIndex = Math.floor((p-1)/PER_PAGE);

      const btn = document.createElement("button");
      btn.className = "sub-btn";
      btn.textContent = `${startP}-${endP}`;

      if(pageIndex === currentPageIndex){
        btn.classList.add("active");
        sub.classList.add("show");
        arrow.textContent = "‚ñº";
      }

      btn.onclick = ()=>{goToPage(pageIndex)};
      sub.appendChild(btn);
    }

    header.onclick = ()=>{
      sub.classList.toggle("show");
      arrow.textContent = sub.classList.contains("show") ? "‚ñº" : "‚ñ∂";
    };

    blockDiv.appendChild(sub);
    tree.appendChild(blockDiv);
  }
}
  document.getElementById("searchInput").addEventListener("keyup", function(e){
  if(e.key === "Enter"){
    goToQuestion();
  }
});

</script>

<footer style="
  margin-top:100px;
  padding:18px;
  text-align:center;
  font-family:'Trebuchet MS', sans-serif;
  background:#fff;
  border-top:2px dashed #ccc;
  color:#333;
  font-size:14px;">
  <span style="opacity:0.8;">Built & Designed by</span>  
  <strong style="color:#2b6cb0;">Dr. Ibrahimov</strong> ‚ö°  
  <div style="margin-top:6px; font-size:12px; opacity:0.6;">
    ¬© 2025 ‚Äî Laboratory Course
  </div>
</footer>
</body>
</html>
